(function(d){String.prototype.splitCSV=function(d){for(var a=this.split(d=d||","),b=a.length-1,e;0<=b;b--)'"'==a[b].replace(/"\s+$/,'"').charAt(a[b].length-1)?1<(e=a[b].replace(/^\s+"/,'"')).length&&'"'==e.charAt(0)?a[b]=a[b].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"'):b?a.splice(b-1,2,[a[b-1],a[b]].join(d)):a=a.shift().split(d).concat(a):a[b].replace(/""/g,'"');return a};d.fn.CSVToTable=function(m,a){a=d.extend({tableClass:"CSVTable",theadClass:"",thClass:"",tbodyClass:"",trClass:"",tdClass:"",
loadingImage:"",loadingText:"Loading CSV data...",separator:",",startLine:0},a);return this.each(function(){var b=d(this),e="";a.loadingImage?loading='<div style="text-align: center"><img alt="'+a.loadingText+'" src="'+a.loadingImage+'" /><br>'+a.loadingText+"</div>":loading=a.loadingText;b.html(loading);d.get(m,function(f){var c='<table class="'+a.tableClass+'">';f=f.replace("\r","").split("\n");var l=0,h=0,g=[];d.each(f,function(b,f){0==b&&"undefined"!=typeof a.headers&&(g=a.headers,h=g.length,
c+='<thead class="'+a.theadClass+'"><tr class="'+a.trClass+'">',d.each(g,function(b,d){c+='<th class="'+a.thClass+'">'+d+"</th>"}),c+='</tr></thead><tbody class="'+a.tbodyClass+'">');if(b==a.startLine&&"undefined"==typeof a.headers)g=f.splitCSV(a.separator),h=g.length,c+='<thead class="'+a.theadClass+'"><tr class="'+a.trClass+'">',d.each(g,function(b,d){c+='<th class="'+a.thClass+'">'+d+"</th>"}),c+='</tr></thead><tbody class="'+a.tbodyClass+'">';else if(b>=a.startLine){var k=f.splitCSV(a.separator);
1<k.length&&(l++,k.length!=h&&(e+="error on line "+b+": Item count ("+k.length+") does not match header count ("+h+") \n"),l%2?oddOrEven="odd":oddOrEven="even",c+='<tr class="'+a.trClass+" "+oddOrEven+'">',d.each(k,function(b,d){c+='<td class="'+a.tdClass+'">'+d+"</td>"}),c+="</tr>")}});c+="</tbody></table>";e?b.html(e):b.fadeOut(500,function(){b.html(c)}).fadeIn(function(){setTimeout(function(){b.trigger("loadComplete")},0)})})})}})(jQuery);